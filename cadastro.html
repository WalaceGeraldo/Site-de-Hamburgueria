<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - The Burguer co.</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header class="main-header">
        <div class="container">
            <h1 class="logo">The Burguer co.</h1>
            <nav class="main-nav">
                 <ul>
                    <li><a href="index.html">Início</a></li>
                    <li><a href="cardapio.html">Cardápio</a></li>
                    <li id="nav-cadastro"><a href="cadastro.html">Cadastro</a></li>
                    <li id="nav-login"><a href="login.html" class="btn-login">Login</a></li>
                    <li id="nav-user" style="display: none;"><span id="user-email" style="color: #ccc; margin-right: 15px;"></span></li>
                    <li id="nav-logout" style="display: none;"><a href="#" id="logout-button" class="btn-logout">Sair</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="cadastro-section">
        <div class="container">
            <div class="cadastro-form-container">
                <h2 class="cadastro-title">Crie sua Conta</h2>

                <form id="cadastroForm">
                    <div class="form-group-cadastro">
                        <label for="nome-completo">Nome Completo:</label>
                        <input type="text" id="nome-completo" name="nome-completo" required>
                    </div>
                    <div class="form-group-cadastro">
                        <label for="email-cadastro">Email:</label>
                        <input type="email" id="email-cadastro" name="email-cadastro" required>
                    </div>
                    <div class="form-group-cadastro">
                        <label for="senha-cadastro">Senha:</label>
                        <input type="password" id="senha-cadastro" name="senha-cadastro" required>
                    </div>
                    <div class="form-group-cadastro">
                        <label for="confirmar-senha">Confirmar Senha:</label>
                        <input type="password" id="confirmar-senha" name="confirmar-senha" required>
                    </div>
                    <button type="submit" class="btn-cadastro">Cadastrar</button>
                </form>

                 <div class="divider"><span>OU</span></div>

                 <button type="button" class="btn-google" id="btnGoogleSignIn">
                     <img src="imagens/icon-google.png" alt="Google icon">
                     Entrar com Google
                 </button>

                <p class="login-link">
                    Já tem uma conta? <a href="login.html">Faça login</a>
                </p>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="container">
             <div class="footer-col footer-logo"><h3>THE BURGUER CO.</h3></div>
            <div class="footer-col"><h4>MAPA DO SITE</h4><ul><li><a href="index.html">INÍCIO</a></li><li><a href="cardapio.html">CARDÁPIO</a></li><li><a href="#">QUEM SOMOS</a></li><li><a href="cadastro.html">CADASTRO</a></li></ul></div>
            <div class="footer-col"><h4>SIGA-NOS NAS REDE SOCIAL</h4><div class="social-icons"><a href="#"><img src="imagens/icon-facebook.png" alt="Facebook"></a><a href="#"><img src="imagens/icon-instagram.png" alt="Instagram"></a><a href="#"><img src="imagens/icon-whatsapp.png" alt="WhatsApp"></a></div></div>
            <div class="footer-col"><h4>PEDIDO ONLINE</h4><ul><li><a href="#">IFOOD</a></li><li><a href="#">WHATSAPP</a></li><li><span>LIGAR: (21) 99999-9999</span></li></ul></div>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>

    <script>
      // --- SUA CONFIGURAÇÃO FIREBASE ---
      const firebaseConfig = {
        apiKey: "AIzaSyC92LK20GbKuIqJ34ol2gRXQ7HBaDo4Ojw", // CONFIRA SE ESTÁ CORRETO
        authDomain: "the-burger-co-site.firebaseapp.com", // CONFIRA SE ESTÁ CORRETO
        projectId: "the-burger-co-site", // CONFIRA SE ESTÁ CORRETO
        storageBucket: "the-burger-co-site.appspot.com", // CONFIRA SE ESTÁ CORRETO
        messagingSenderId: "264313917347", // CONFIRA SE ESTÁ CORRETO
        appId: "1:264313917347:web:6913602d31678a3d451416" // CONFIRA SE ESTÁ CORRETO
      };
      // --- FIM DA CONFIGURAÇÃO ---

      try {
          // Inicializar Firebase
          firebase.initializeApp(firebaseConfig);
          const auth = firebase.auth();
          const googleProvider = new firebase.auth.GoogleAuthProvider();

          // --- Lógica do Formulário de Cadastro (Email/Senha) ---
          const cadastroForm = document.getElementById('cadastroForm');
          if (cadastroForm) {
              cadastroForm.addEventListener('submit', (event) => {
                  event.preventDefault();
                  const email = document.getElementById('email-cadastro').value;
                  const senha = document.getElementById('senha-cadastro').value;
                  const confirmarSenha = document.getElementById('confirmar-senha').value;

                  if (senha !== confirmarSenha) { alert("As senhas não coincidem!"); return; }
                  if (senha.length < 6) { alert("A senha deve ter pelo menos 6 caracteres."); return; }

                  auth.createUserWithEmailAndPassword(email, senha)
                    .then((userCredential) => {
                      alert('Cadastro realizado com sucesso!');
                      window.location.href = 'login.html';
                    })
                    .catch((error) => {
                      console.error('Erro no cadastro:', error.code, error.message);
                      if (error.code === 'auth/email-already-in-use') { alert('Este e-mail já está cadastrado.'); }
                      else if (error.code === 'auth/weak-password') { alert('A senha deve ter pelo menos 6 caracteres.'); }
                      else { alert('Erro ao cadastrar: ' + error.message); }
                    });
              });
          }

          // --- Lógica do Login com Google (no cadastro) ---
          const btnGoogleSignIn = document.getElementById('btnGoogleSignIn');
          if (btnGoogleSignIn) {
              btnGoogleSignIn.addEventListener('click', () => {
                  auth.signInWithPopup(googleProvider)
                    .then((result) => {
                      alert('Login com Google realizado com sucesso!');
                      window.location.href = 'index.html';
                    }).catch((error) => {
                      console.error('Erro no login com Google (cadastro):', error.code, error.message);
                      if (error.code !== 'auth/popup-closed-by-user') { alert('Erro ao tentar login com Google: ' + error.message); }
                    });
              });
          }

          // --- LÓGICA PARA ATUALIZAR O CABEÇALHO (ESSENCIAL!) ---
          const navCadastro = document.getElementById('nav-cadastro');
          const navLogin = document.getElementById('nav-login');
          const navUser = document.getElementById('nav-user');
          const navLogout = document.getElementById('nav-logout');
          const userEmailSpan = document.getElementById('user-email');
          const logoutButton = document.getElementById('logout-button');

          auth.onAuthStateChanged((user) => {
            console.log("Auth state changed on cadastro.html:", user); // Log para depuração
            if (user) {
              // Usuário está logado
              userEmailSpan.textContent = `Olá, ${user.email}`;
              if(navCadastro) navCadastro.style.display = 'none';
              if(navLogin) navLogin.style.display = 'none';
              if(navUser) navUser.style.display = 'list-item';
              if(navLogout) navLogout.style.display = 'list-item';
            } else {
              // Usuário está deslogado
              userEmailSpan.textContent = '';
              if(navCadastro) navCadastro.style.display = 'list-item';
              if(navLogin) navLogin.style.display = 'list-item';
              if(navUser) navUser.style.display = 'none';
              if(navLogout) navLogout.style.display = 'none';
            }
          });

          // Lógica do botão Sair (ESSENCIAL!)
          if (logoutButton) {
              logoutButton.addEventListener('click', (event) => {
                  event.preventDefault();
                  auth.signOut().then(() => {
                      alert('Você saiu da sua conta.');
                      // O onAuthStateChanged vai atualizar o header automaticamente
                      // Opcional: redirecionar, mas já estamos no cadastro... talvez para home?
                       window.location.href = 'index.html';
                  }).catch((error) => {
                      console.error('Erro ao fazer logout:', error);
                      alert('Erro ao sair: ' + error.message);
                  });
              });
          }
          // --- FIM DA LÓGICA DO CABEÇALHO ---

      } catch (e) {
          console.error("Erro ao inicializar Firebase ou configurar listeners em cadastro.html:", e);
          alert("Ocorreu um erro crítico na página de cadastro. Verifique o console.");
      }

    </script>
</body>
</html>